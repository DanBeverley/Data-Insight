<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataInsight AI</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <span>DataInsight AI</span>
                </div>
                <div class="status-indicator" id="statusIndicator">
                    <span class="status-dot"></span>
                    <span class="status-text">Ready</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <div class="container">
                <!-- Step 1: Data Input -->
                <section class="section" id="dataInputSection">
                    <div class="section-header">
                        <h2><span class="step-number">01</span> Data Input</h2>
                        <p>Upload your dataset or provide a URL to get started</p>
                    </div>
                    
                    <div class="input-methods">
                        <div class="input-method active" data-method="upload">
                            <div class="method-header">
                                <i class="fas fa-upload"></i>
                                <span>Upload File</span>
                            </div>
                            <div class="upload-zone" id="uploadZone">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Drag & drop your CSV/Excel file here</p>
                                <p class="subtext">or click to browse</p>
                                <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" hidden>
                            </div>
                        </div>
                        
                        <div class="method-divider">
                            <span>OR</span>
                        </div>
                        
                        <div class="input-method" data-method="url">
                            <div class="method-header">
                                <i class="fas fa-link"></i>
                                <span>URL Data Source</span>
                            </div>
                            <div class="url-input-container">
                                <input type="url" id="urlInput" placeholder="https://example.com/data.csv" class="url-input">
                                <button id="urlSubmit" class="btn btn-primary">
                                    <i class="fas fa-download"></i>
                                    Fetch
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Step 2: Data Preview & Intelligence -->
                <section class="section hidden" id="dataPreviewSection">
                    <div class="section-header">
                        <h2><span class="step-number">02</span> Data Intelligence</h2>
                        <p>AI-powered data understanding and insights</p>
                    </div>
                    
                    <div class="data-info-grid">
                        <div class="info-card">
                            <div class="info-icon">
                                <i class="fas fa-table"></i>
                            </div>
                            <div class="info-content">
                                <span class="info-label">Dataset Shape</span>
                                <span class="info-value" id="dataShape">-</span>
                            </div>
                        </div>
                        
                        <div class="info-card">
                            <div class="info-icon">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="info-content">
                                <span class="info-label">Domain Detected</span>
                                <span class="info-value" id="domainDetected">-</span>
                            </div>
                        </div>
                        
                        <div class="info-card">
                            <div class="info-icon">
                                <i class="fas fa-project-diagram"></i>
                            </div>
                            <div class="info-content">
                                <span class="info-label">Relationships</span>
                                <span class="info-value" id="relationshipCount">-</span>
                            </div>
                        </div>
                        
                        <div class="info-card">
                            <div class="info-icon quality-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="info-content">
                                <span class="info-label">Data Quality</span>
                                <span class="info-value" id="qualityStatus">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Intelligence Tabs -->
                    <div class="intelligence-tabs">
                        <div class="tab-nav">
                            <button class="tab-button active" data-tab="overview">Overview</button>
                            <button class="tab-button" data-tab="semantic">Semantic Types</button>
                            <button class="tab-button" data-tab="relationships">Relationships</button>
                            <button class="tab-button" data-tab="recommendations">Insights</button>
                        </div>
                        
                        <div class="tab-content">
                            <!-- Overview Tab -->
                            <div class="tab-panel active" id="overviewTab">
                                <div class="data-preview-container">
                                    <div class="preview-header">
                                        <h3>Data Preview</h3>
                                        <div class="preview-actions">
                                            <button id="generateEDA" class="btn btn-secondary">
                                                <i class="fas fa-chart-bar"></i>
                                                Generate EDA
                                            </button>
                                            <button id="deepProfile" class="btn btn-primary">
                                                <i class="fas fa-search-plus"></i>
                                                Deep Profile
                                            </button>
                                        </div>
                                    </div>
                                    <div class="table-container">
                                        <table id="dataPreviewTable" class="data-table">
                                            <thead></thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Semantic Types Tab -->
                            <div class="tab-panel" id="semanticTab">
                                <div class="semantic-types-container">
                                    <div class="semantic-legend">
                                        <h4>Detected Semantic Types</h4>
                                        <div id="semanticTypesLegend" class="types-legend"></div>
                                    </div>
                                    <div class="semantic-table-container">
                                        <table id="semanticTypesTable" class="semantic-table">
                                            <thead>
                                                <tr>
                                                    <th>Column</th>
                                                    <th>Semantic Type</th>
                                                    <th>Confidence</th>
                                                    <th>Recommendations</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Relationships Tab -->
                            <div class="tab-panel" id="relationshipsTab">
                                <div class="relationships-container">
                                    <div class="relationship-graph-container">
                                        <h4>Column Relationships</h4>
                                        <div id="relationshipGraph" class="graph-container">
                                            <div class="graph-placeholder">
                                                <i class="fas fa-project-diagram"></i>
                                                <p>Click "Generate Graph" to visualize relationships</p>
                                                <button id="generateGraph" class="btn btn-primary">Generate Graph</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="relationship-details">
                                        <h4>Relationship Details</h4>
                                        <div id="relationshipsList" class="relationships-list"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Recommendations Tab -->
                            <div class="tab-panel" id="recommendationsTab">
                                <div class="recommendations-container">
                                    <div class="insights-summary">
                                        <h4>Key Insights</h4>
                                        <div id="keyInsights" class="insights-list"></div>
                                    </div>
                                    <div class="feature-recommendations">
                                        <h4>Feature Engineering Recommendations</h4>
                                        <div class="recommendations-header">
                                            <select id="priorityFilter" class="filter-select">
                                                <option value="">All Priorities</option>
                                                <option value="high">High Priority</option>
                                                <option value="medium">Medium Priority</option>
                                                <option value="low">Low Priority</option>
                                            </select>
                                            <button id="getRecommendations" class="btn btn-primary">
                                                <i class="fas fa-magic"></i>
                                                Get Recommendations
                                            </button>
                                        </div>
                                        <div id="featureRecommendations" class="recommendations-list"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="validation-issues" id="validationIssues">
                        <!-- Validation issues will be populated here -->
                    </div>
                    
                    <div class="processing-actions">
                        <button id="continueToConfig" class="btn btn-primary btn-large">
                            <i class="fas fa-arrow-right"></i>
                            Continue to Configuration
                        </button>
                    </div>
                </section>

                <!-- Step 3: Task Configuration -->
                <section class="section hidden" id="taskConfigSection">
                    <div class="section-header">
                        <h2><span class="step-number">03</span> Task Configuration</h2>
                        <p>Configure your machine learning task and target</p>
                    </div>
                    
                    <div class="config-grid">
                        <div class="config-group">
                            <label for="taskSelect">ML Task</label>
                            <select id="taskSelect" class="select-input">
                                <option value="classification">Classification</option>
                                <option value="regression">Regression</option>
                                <option value="clustering">Clustering</option>
                                <option value="timeseries">Time-Series Forecasting</option>
                                <option value="nlp">NLP Text Analysis</option>
                            </select>
                        </div>
                        
                        <div class="config-group" id="targetColumnGroup">
                            <label for="targetSelect">Target Column</label>
                            <select id="targetSelect" class="select-input">
                                <option value="">Select target column...</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="advanced-config">
                        <div class="config-toggle">
                            <input type="checkbox" id="advancedToggle">
                            <label for="advancedToggle">Advanced Options</label>
                        </div>
                        
                        <div class="advanced-options hidden" id="advancedOptions">
                            <div class="config-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="enableIntelligence" checked>
                                    <span class="checkmark"></span>
                                    Enable AI Intelligence Features
                                </label>
                                <small class="help-text">Semantic understanding, domain detection, relationship discovery</small>
                            </div>
                            
                            <div class="config-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="robustPipeline" checked>
                                    <span class="checkmark"></span>
                                    Use Robust Pipeline
                                </label>
                                <small class="help-text">Production-grade pipeline with error recovery</small>
                            </div>
                            
                            <div class="config-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="adaptiveLearning" checked>
                                    <span class="checkmark"></span>
                                    Enable Adaptive Learning
                                </label>
                                <small class="help-text">Learn from execution patterns to improve recommendations</small>
                            </div>

                            <div class="config-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="featureGeneration">
                                    <span class="checkmark"></span>
                                    Enable Automated Feature Generation
                                </label>
                            </div>
                            
                            <div class="config-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="featureSelection">
                                    <span class="checkmark"></span>
                                    Enable Intelligent Feature Selection
                                </label>
                            </div>
                        </div>
                        
                        <!-- Start Processing Button -->
                        <div class="processing-actions">
                            <button id="startProcessing" class="btn btn-primary btn-large">
                                <i class="fas fa-play"></i>
                                Start Processing
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Step 4: Processing -->
                <section class="section hidden" id="processingSection">
                    <div class="section-header">
                        <h2><span class="step-number">04</span> Processing</h2>
                        <p>AI is analyzing and transforming your data</p>
                    </div>
                    
                    <div class="processing-container">
                        <div class="processing-animation">
                            <div class="processing-circle">
                                <div class="processing-inner">
                                    <i class="fas fa-brain"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="processing-status">
                            <h3 id="processingStatusText">Initializing...</h3>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                            <p id="processingStepText">Preparing data analysis...</p>
                        </div>
                        
                        <!-- Pipeline Status Monitor -->
                        <div class="pipeline-monitor hidden" id="pipelineMonitor">
                            <div class="monitor-header">
                                <h4>Pipeline Status</h4>
                                <div class="pipeline-type">
                                    <span class="type-badge" id="pipelineType">-</span>
                                </div>
                            </div>
                            <div class="pipeline-stages">
                                <div class="stage-item" data-stage="ingestion">
                                    <div class="stage-icon"><i class="fas fa-upload"></i></div>
                                    <span class="stage-name">Data Ingestion</span>
                                    <div class="stage-status pending"></div>
                                </div>
                                <div class="stage-item" data-stage="profiling">
                                    <div class="stage-icon"><i class="fas fa-search"></i></div>
                                    <span class="stage-name">Intelligence Profiling</span>
                                    <div class="stage-status pending"></div>
                                </div>
                                <div class="stage-item" data-stage="cleaning">
                                    <div class="stage-icon"><i class="fas fa-broom"></i></div>
                                    <span class="stage-name">Data Cleaning</span>
                                    <div class="stage-status pending"></div>
                                </div>
                                <div class="stage-item" data-stage="feature_engineering">
                                    <div class="stage-icon"><i class="fas fa-magic"></i></div>
                                    <span class="stage-name">Feature Engineering</span>
                                    <div class="stage-status pending"></div>
                                </div>
                                <div class="stage-item" data-stage="modeling">
                                    <div class="stage-icon"><i class="fas fa-robot"></i></div>
                                    <span class="stage-name">Modeling</span>
                                    <div class="stage-status pending"></div>
                                </div>
                            </div>
                            <div class="monitor-actions">
                                <button id="refreshStatus" class="btn btn-secondary btn-small">
                                    <i class="fas fa-sync"></i>
                                    Refresh
                                </button>
                                <button id="triggerRecovery" class="btn btn-warning btn-small hidden">
                                    <i class="fas fa-first-aid"></i>
                                    Recover
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <button id="startProcessing" class="btn btn-primary btn-large">
                        <i class="fas fa-play"></i>
                        Start Processing
                    </button>
                </section>

                <!-- Step 5: Results -->
                <section class="section hidden" id="resultsSection">
                    <div class="section-header">
                        <h2><span class="step-number">05</span> Results</h2>
                        <p>Processing complete! Review and download your results</p>
                    </div>
                    
                    <div class="results-summary">
                        <div class="summary-card">
                            <h3>Processing Summary</h3>
                            <div class="summary-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Original Shape:</span>
                                    <span class="stat-value" id="originalShape">-</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Processed Shape:</span>
                                    <span class="stat-value" id="processedShape">-</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Processing Time:</span>
                                    <span class="stat-value" id="processingTime">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="column-roles-card">
                            <h3>Column Classification</h3>
                            <div id="columnRoles" class="column-roles">
                                <!-- Column roles will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="downloads-section">
                        <h3>Download Artifacts</h3>
                        <div class="download-grid">
                            <button class="download-btn" id="downloadData">
                                <i class="fas fa-table"></i>
                                <span>Processed Data</span>
                                <small>CSV format</small>
                            </button>
                            
                            <button class="download-btn" id="downloadEnhancedData">
                                <i class="fas fa-magic"></i>
                                <span>Enhanced Data</span>
                                <small>With engineered features</small>
                            </button>
                            
                            <button class="download-btn" id="downloadPipeline">
                                <i class="fas fa-cogs"></i>
                                <span>ML Pipeline</span>
                                <small>Joblib format</small>
                            </button>
                            
                            <button class="download-btn" id="downloadIntelligence">
                                <i class="fas fa-brain"></i>
                                <span>Intelligence Report</span>
                                <small>Complete analysis</small>
                            </button>
                            
                            <button class="download-btn" id="downloadLineage">
                                <i class="fas fa-file-alt"></i>
                                <span>Lineage Report</span>
                                <small>Processing history</small>
                            </button>
                            
                            <button class="download-btn" id="downloadMetadata">
                                <i class="fas fa-info-circle"></i>
                                <span>Pipeline Metadata</span>
                                <small>Execution details</small>
                            </button>
                        </div>
                    </div>
                    
                    <div class="restart-section">
                        <button id="processNewData" class="btn btn-secondary">
                            <i class="fas fa-redo"></i>
                            Process New Dataset
                        </button>
                    </div>
                </section>
            </div>
        </main>

        <!-- Loading Overlay -->
        <div class="loading-overlay hidden" id="loadingOverlay">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p id="loadingText">Loading...</p>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <script src="/static/script.js"></script>
    <script src="/static/chat_interface.js"></script>
</body>
</html>